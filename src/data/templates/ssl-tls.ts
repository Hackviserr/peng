import type { FindingTemplate } from '../../constants';

export const sslTlsTemplates: FindingTemplate[] = [
    {
        id: 'ssl-expired-cert',
        title: 'Expired SSL/TLS Certificate',
        category: 'SSL/TLS',
        severity: 'Medium',
        cwe: 'CWE-298',
        cvss: '5.9',
        owasp: 'A02:2021 Cryptographic Failures',
        affectedHost: 'app.example.com',
        port: '443',
        tags: ['ssl', 'tls', 'certificate', 'expired', 'x509'],
        description: '<p>The server presents an SSL/TLS certificate that has exceeded its validity period. Expired certificates are not trusted by browsers and security-conscious clients, causing certificate warnings that undermine user trust and may train users to bypass security warnings â€” a behavior that attackers can exploit.</p><p>An expired certificate also indicates potential lapses in certificate lifecycle management processes, suggesting that other security maintenance tasks may also be neglected.</p><p>Testing confirmed that the certificate on the identified host has an expiration date in the past, and browsers display untrusted connection warnings when accessing the service.</p>',
        impact: '<ul><li><strong>Loss of User Trust:</strong> Visitors see browser security warnings, reducing confidence in the application.</li><li><strong>Man-in-the-Middle Risk:</strong> Users trained to click through certificate warnings become vulnerable to MitM attacks with self-signed or invalid certificates.</li><li><strong>Service Disruption:</strong> API clients and automated systems configured with strict certificate validation will fail to connect.</li><li><strong>Compliance Violations:</strong> Valid SSL/TLS certificates are required by PCI-DSS, HIPAA, and most security compliance frameworks.</li></ul>',
        remediation: '<ol><li><strong>Renew Certificate Immediately:</strong> Obtain and install a valid SSL/TLS certificate from a trusted Certificate Authority (CA).</li><li><strong>Automated Renewal:</strong> Use automated certificate management tools like Let\'s Encrypt with Certbot, or cloud provider certificate managers (ACM, Cloud SSL) for automatic renewal.</li><li><strong>Certificate Monitoring:</strong> Implement certificate expiration monitoring with alerts at 30, 14, and 7 days before expiry.</li><li><strong>Certificate Inventory:</strong> Maintain a complete inventory of all certificates deployed across all environments.</li></ol>',
        references: '<p><ul><li><a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 - A02:2021</a></li><li><a href="https://cwe.mitre.org/data/definitions/298.html">CWE-298: Improper Validation of Certificate Expiration</a></li></ul></p>',
    },
    {
        id: 'ssl-weak-cipher',
        title: 'Weak SSL/TLS Cipher Suites Supported',
        category: 'SSL/TLS',
        severity: 'Medium',
        cwe: 'CWE-326',
        cvss: '5.3',
        owasp: 'A02:2021 Cryptographic Failures',
        affectedHost: 'app.example.com',
        port: '443',
        tags: ['ssl', 'tls', 'cipher', 'weak', 'encryption', 'des', 'rc4'],
        description: '<p>The server supports weak or deprecated cipher suites that do not provide adequate cryptographic protection for transmitted data. Identified weak ciphers may include those using DES, 3DES, RC4, NULL encryption, export-grade ciphers (40/56-bit), or cipher suites without forward secrecy.</p><p>Known attacks against weak ciphers include SWEET32 (against 3DES and other 64-bit block ciphers), RC4 biases, and BEAST/CRIME/BREACH attacks. These vulnerabilities allow attackers with network access to potentially decrypt TLS-protected communications.</p><p>Testing using tools such as testssl.sh, ssllabs.com, or nmap ssl-enum-ciphers identified support for cipher suites that are considered cryptographically weak by current standards.</p>',
        impact: '<ul><li><strong>Data Decryption:</strong> Weak ciphers may allow attackers to decrypt intercepted traffic, exposing sensitive data including credentials, personal information, and API tokens.</li><li><strong>Downgrade Attacks:</strong> Support for weak ciphers enables protocol downgrade attacks where an active attacker forces the use of the weakest supported cipher.</li><li><strong>Compliance Failures:</strong> PCI-DSS, NIST, and other standards explicitly prohibit weak cipher suites.</li></ul>',
        remediation: '<ol><li><strong>Disable Weak Ciphers:</strong> Remove support for all cipher suites using DES, 3DES, RC4, NULL encryption, and export-grade ciphers.</li><li><strong>Enable Modern Ciphers:</strong> Configure the server to support only strong cipher suites with AEAD (AES-GCM, ChaCha20-Poly1305) and forward secrecy (ECDHE, DHE).</li><li><strong>Recommended Configuration:</strong> Follow Mozilla\'s SSL Configuration Generator for recommended cipher suite ordering for your server software.</li><li><strong>Disable Old Protocols:</strong> Disable SSLv3, TLS 1.0, and TLS 1.1. Require TLS 1.2 as a minimum, with TLS 1.3 preferred.</li></ol>',
        references: '<p><ul><li><a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 - A02:2021</a></li><li><a href="https://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a></li><li><a href="https://ssl-config.mozilla.org/">Mozilla SSL Configuration Generator</a></li><li><a href="https://www.ssllabs.com/ssltest/">SSL Labs Server Test</a></li></ul></p>',
    },
    {
        id: 'ssl-missing-hsts',
        title: 'Missing HTTP Strict Transport Security (HSTS)',
        category: 'SSL/TLS',
        severity: 'Low',
        cwe: 'CWE-319',
        cvss: '4.3',
        owasp: 'A02:2021 Cryptographic Failures',
        affectedHost: 'app.example.com',
        port: '443',
        tags: ['hsts', 'ssl', 'tls', 'https', 'transport-security', 'header'],
        description: '<p>The application does not send the <code>Strict-Transport-Security</code> (HSTS) header in its HTTPS responses. HSTS instructs browsers to always connect to the site via HTTPS, preventing protocol downgrade attacks and cookie hijacking.</p><p>Without HSTS, users who type the domain name without "https://" or follow HTTP links will initially connect over unencrypted HTTP before being redirected to HTTPS. During this brief window, an attacker performing a man-in-the-middle attack can intercept the connection using SSL stripping techniques (e.g., sslstrip).</p>',
        impact: '<ul><li><strong>SSL Stripping:</strong> Active network attackers can intercept the initial HTTP request and prevent the upgrade to HTTPS, serving a plaintext version of the site.</li><li><strong>Cookie Hijacking:</strong> Without HSTS, cookies set without the Secure flag may be transmitted over HTTP, allowing interception.</li><li><strong>Phishing Facilitation:</strong> Users cannot rely on HTTPS indicators as a trust signal if HTTPS is not consistently enforced.</li></ul>',
        remediation: '<ol><li><strong>Add HSTS Header:</strong> Configure the web server to send: <code>Strict-Transport-Security: max-age=31536000; includeSubDomains; preload</code></li><li><strong>Start Gradually:</strong> Begin with a short max-age (e.g., 300 seconds) to verify proper configuration, then increase to 1 year (31536000 seconds).</li><li><strong>Include Subdomains:</strong> Add <code>includeSubDomains</code> to protect all subdomains.</li><li><strong>HSTS Preloading:</strong> Submit the domain to the HSTS Preload List (hstspreload.org) for inclusion in browsers\' built-in HSTS lists.</li><li><strong>HTTP to HTTPS Redirect:</strong> Configure permanent (301) redirects from HTTP to HTTPS on all endpoints.</li></ol>',
        references: '<p><ul><li><a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 - A02:2021</a></li><li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li><li><a href="https://hstspreload.org/">HSTS Preload List</a></li><li><a href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html">OWASP HSTS Cheat Sheet</a></li></ul></p>',
    },
];
